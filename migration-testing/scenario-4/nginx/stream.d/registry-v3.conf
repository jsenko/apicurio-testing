# Apicurio Registry v3.1.x TLS passthrough configuration
# This configuration forwards TLS traffic directly to Registry 3.1.x without decryption
# USE THIS FILE TO ROUTE TRAFFIC TO V3 DURING MIGRATION (Step I)

upstream registry_backend {
    # Point to the v3 registry container (HTTPS)
    server scenario4-registry-v3:8443 max_fails=3 fail_timeout=30s;
}

server {
    listen 8443;

    # TCP/TLS passthrough - forward encrypted traffic directly to backend
    proxy_pass registry_backend;

    # Timeouts
    proxy_connect_timeout 60s;
    proxy_timeout 300s;
}
